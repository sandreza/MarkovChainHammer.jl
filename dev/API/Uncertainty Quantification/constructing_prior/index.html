<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Constructing Prior Distributions · Markov Chain Hammer</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Markov Chain Hammer</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Discrete Time</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Discrete Time/transfer_operators/">Transfer Operators and Markov Chains</a></li><li><a class="tocitem" href="../../Discrete Time/empirical_transfer_operators/">Data-driven Transfer Operators</a></li><li><a class="tocitem" href="../../Discrete Time/convergence/">Convergence of Transfer Operators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Continuous Time</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Continuous Time/generators/">Generators</a></li><li><a class="tocitem" href="../../Continuous Time/empirical_generator/">Empirical Generator</a></li><li><a class="tocitem" href="../../Continuous Time/convergence/">Convergence of Generators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Uncertainty Quantification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../bayesian_empirical_generator/">Bayesian Empirical Generator</a></li><li class="is-active"><a class="tocitem" href>Constructing Prior Distributions</a></li><li><a class="tocitem" href="../sampling/">Sampling from the Bayesian Generator</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Modules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Modules/module_overview/">Overview</a></li><li><a class="tocitem" href="../../../Modules/transition_matrix/">TransitionMatrix</a></li><li><a class="tocitem" href="../../../Modules/bayesian_matrix/">BayesianMatrix</a></li><li><a class="tocitem" href="../../../Modules/trajectory/">Trajectory</a></li><li><a class="tocitem" href="../../../Modules/clustering/">Clustering</a></li><li><a class="tocitem" href="../../../Modules/utils/">Utils</a></li></ul></li><li><a class="tocitem" href="../../../function_index/">Function Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">Uncertainty Quantification</a></li><li class="is-active"><a href>Constructing Prior Distributions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Constructing Prior Distributions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sandreza/MarkovChainHammer.jl/blob/main/docs/src/API/Uncertainty Quantification/constructing_prior.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="sec:constructing_priors"><a class="docs-heading-anchor" href="#sec:constructing_priors">Constructing Prior Distributions</a><a id="sec:constructing_priors-1"></a><a class="docs-heading-anchor-permalink" href="#sec:constructing_priors" title="Permalink"></a></h1><p>In the previous section we saw how to use the BayesianGenerator object, similar to how we use the generator function. We now introduce the GeneratorParameterDistribution object in order to construct prior distributions for Bayesian inference. </p><p>We first load the necessary packages and functions</p><pre><code class="language-julia hljs">using Random, MarkovChainHammer, Statistics
using MarkovChainHammer.BayesianMatrix
using MarkovChainHammer.TransitionMatrix: generator
using MarkovChainHammer.Trajectory: generate
Random.seed!(1234)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><p>We now introduce the GeneratorParameterDistribution object, which was exported from MarkovChainHammer.BayesianMatrix</p><pre><code class="language-julia hljs">number_of_states = 3
prior = GeneratorParameterDistributions(number_of_states)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GeneratorParameterDistributions 
rates  
3-element Vector{Distributions.Gamma{Float64}}:
 Distributions.Gamma{Float64}(α=1.0, θ=1.0)
 Distributions.Gamma{Float64}(α=1.0, θ=1.0)
 Distributions.Gamma{Float64}(α=1.0, θ=1.0)exit_probabilities  
3-element Vector{Distributions.Dirichlet{Float64, Vector{Float64}, Float64}}:
 Distributions.Dirichlet{Float64, Vector{Float64}, Float64}(alpha=[1.0, 1.0])
 Distributions.Dirichlet{Float64, Vector{Float64}, Float64}(alpha=[1.0, 1.0])
 Distributions.Dirichlet{Float64, Vector{Float64}, Float64}(alpha=[1.0, 1.0])</code></pre><p>The prior distribution constitutes a guess for the entries of the matrix. We can check the mean of a random matrix generator from the prior distribution by calling the mean function on the prior</p><pre><code class="language-julia hljs">mean(prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 Matrix{Float64}:
 -1.0   0.5   0.5
  0.5  -1.0   0.5
  0.5   0.5  -1.0</code></pre><p>From a generator we now create a markov chain</p><pre><code class="language-julia hljs">Q = [-1.0 4/3 2; 1/4 -2.0 1; 3/4 2/3 -3.0]
dt = 0.01
markov_chain = generate(Q, 10000; dt = dt)&#39;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10000 adjoint(::Vector{Int64}) with eltype Int64:
 1  1  1  1  1  1  1  1  1  1  1  1  1  …  1  1  1  1  1  1  1  1  1  1  1  1</code></pre><p>and now use our prior distribution along with the BayesianGenerator object</p><pre><code class="language-julia hljs">Q_bayes = BayesianGenerator(markov_chain, prior; dt = dt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BayesianGenerator 
prior variance  
3×3 Matrix{Float64}:
 1.0       0.416667  0.416667
 0.416667  1.0       0.416667
 0.416667  0.416667  1.0prior mean  
3×3 Matrix{Float64}:
 -1.0   0.5   0.5
  0.5  -1.0   0.5
  0.5   0.5  -1.0posterior variance  
3×3 Matrix{Float64}:
 0.0182632   0.0550691  0.0995698
 0.00443534  0.0847981  0.0302305
 0.0138278   0.0285697  0.130521posterior mean  
3×3 Matrix{Float64}:
 -1.13067    1.064      2.19547
  0.274592  -1.62134    0.672081
  0.856081   0.557335  -2.86755</code></pre><p>We see that we get a different answer than what we had before due to the presence of the prior distribution</p><pre><code class="language-julia hljs">Q_bayes_uninformative_prior = BayesianGenerator(markov_chain; dt = dt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BayesianGenerator 
prior variance  
3×3 Matrix{Float64}:
 7.03687e13  3.51844e13  3.51844e13
 3.51844e13  7.03687e13  3.51844e13
 3.51844e13  3.51844e13  7.03687e13prior mean  
3×3 Matrix{Float64}:
 -1.0   0.5   0.5
  0.5  -1.0   0.5
  0.5   0.5  -1.0posterior variance  
3×3 Matrix{Float64}:
 0.0185982   0.0609135  0.109155
 0.00442456  0.0913703  0.0318369
 0.0142707   0.0304568  0.140992posterior mean  
3×3 Matrix{Float64}:
 -1.13282    1.10375    2.28898
  0.266546  -1.65563    0.66762
  0.866273   0.551876  -2.9566</code></pre><p>In particular we can check the mean </p><pre><code class="language-julia hljs">mean(Q_bayes) - mean(Q_bayes_uninformative_prior)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 Matrix{Float64}:
  0.00214535  -0.0397491   -0.0935189
  0.00804652   0.0342902    0.00446084
 -0.0101919    0.00545887   0.089058</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bayesian_empirical_generator/">« Bayesian Empirical Generator</a><a class="docs-footer-nextpage" href="../sampling/">Sampling from the Bayesian Generator »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 12 March 2023 19:54">Sunday 12 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
