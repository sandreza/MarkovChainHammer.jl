<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bayesian Empirical Generator · Markov Chain Hammer</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Markov Chain Hammer</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../overview/">Overview</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Discrete Time</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Discrete Time/transfer_operators/">Transfer Operators and Markov Chains</a></li><li><a class="tocitem" href="../../Discrete Time/empirical_transfer_operators/">Data-driven Transfer Operators</a></li><li><a class="tocitem" href="../../Discrete Time/convergence/">Convergence of Transfer Operators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox"/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Continuous Time</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../Continuous Time/generators/">Generators</a></li><li><a class="tocitem" href="../../Continuous Time/empirical_generator/">Empirical Generator</a></li><li><a class="tocitem" href="../../Continuous Time/convergence/">Convergence of Generators</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Uncertainty Quantification</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Bayesian Empirical Generator</a></li><li><a class="tocitem" href="../constructing_prior/">Constructing Prior Distributions</a></li><li><a class="tocitem" href="../sampling/">Sampling from the Bayesian Generator</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Modules</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../Modules/module_overview/">Overview</a></li><li><a class="tocitem" href="../../../Modules/transition_matrix/">TransitionMatrix</a></li><li><a class="tocitem" href="../../../Modules/bayesian_matrix/">BayesianMatrix</a></li><li><a class="tocitem" href="../../../Modules/trajectory/">Trajectory</a></li><li><a class="tocitem" href="../../../Modules/clustering/">Clustering</a></li><li><a class="tocitem" href="../../../Modules/utils/">Utils</a></li></ul></li><li><a class="tocitem" href="../../../function_index/">Function Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">Uncertainty Quantification</a></li><li class="is-active"><a href>Bayesian Empirical Generator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bayesian Empirical Generator</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sandreza/MarkovChainHammer.jl/blob/main/docs/src/API/Uncertainty Quantification/bayesian_empirical_generator.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="sec:bayesian_empirical"><a class="docs-heading-anchor" href="#sec:bayesian_empirical">Bayesian Empirical Generator</a><a id="sec:bayesian_empirical-1"></a><a class="docs-heading-anchor-permalink" href="#sec:bayesian_empirical" title="Permalink"></a></h1><p>In this section we will show how to utilise the Bayesian empirical generator to estimate the uncertainty of the entries in the empirical generator from finite data. We we will do so by generating a Markov chain from a generator matrix. First let&#39;s load a few packages and functions that we&#39;ve become familiar with over the last few sections.</p><pre><code class="language-julia hljs">using Random, MarkovChainHammer, Statistics
using MarkovChainHammer.TransitionMatrix: generator
using MarkovChainHammer.Trajectory: generate
Random.seed!(1234)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Random.TaskLocalRNG()</code></pre><p>Observe the use of the Random package to set the seed for the random number generator. This is important for reproducibility of the results. A seed should only be defined once at the beginning of a script. </p><p>We will now create a generator matrix Q and generate a markov process.</p><pre><code class="language-julia hljs">Q = [-1.0 4/3 2; 1/4 -2.0 1; 3/4 2/3 -3.0]
dt = 0.01
markov_chain = generate(Q, 10000; dt = dt)&#39;</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×10000 adjoint(::Vector{Int64}) with eltype Int64:
 1  1  1  1  1  1  1  1  1  1  1  1  1  …  1  1  1  1  1  1  1  1  1  1  1  1</code></pre><p>We first construct the empirical generator as before to serve as a comparison point for the Bayesian empirical generator which will come later.</p><pre><code class="language-julia hljs">Qempirical = generator(markov_chain; dt = dt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 Matrix{Float64}:
 -1.13282    1.10375    2.28898
  0.266546  -1.65563    0.66762
  0.866273   0.551876  -2.9566</code></pre><p>We are now ready to introduce the Bayesian Generator matrix. We first load in the BayesianMatrix submodule.</p><pre><code class="language-julia hljs">using MarkovChainHammer.BayesianMatrix</code></pre><p>This submodule naturally exports a number of structs and functions. We can see the names of these functions by typing the following: </p><pre><code class="language-julia hljs">names(MarkovChainHammer.BayesianMatrix)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8-element Vector{Symbol}:
 :BayesianGenerator
 :BayesianMatrix
 :GeneratorParameterDistributions
 :eigen_distribution
 :eigvals_distribution
 :params
 :uninformative_prior
 :unpack</code></pre><p>In particular a BayesianGenerator object is exported. We use the BayesianGenerator just like a normal generator in order to construct a BayesianGenerator</p><pre><code class="language-julia hljs">Q_bayes = BayesianGenerator(markov_chain; dt = dt)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">BayesianGenerator 
prior variance  
3×3 Matrix{Float64}:
 7.03687e13  3.51844e13  3.51844e13
 3.51844e13  7.03687e13  3.51844e13
 3.51844e13  3.51844e13  7.03687e13prior mean  
3×3 Matrix{Float64}:
 -1.0   0.5   0.5
  0.5  -1.0   0.5
  0.5   0.5  -1.0posterior variance  
3×3 Matrix{Float64}:
 0.0185982   0.0609135  0.109155
 0.00442456  0.0913703  0.0318369
 0.0142707   0.0304568  0.140992posterior mean  
3×3 Matrix{Float64}:
 -1.13282    1.10375    2.28898
  0.266546  -1.65563    0.66762
  0.866273   0.551876  -2.9566</code></pre><p>This is no longer a regular matrix, but rather a random matrix whose entries are given by a probability distribution consistent with finite sampling from a markov process. In the present context (this will change later when we discuss prior distributions) the mean of the Bayesian matrix reproduces the same matrix as the empirically obtained matrix, as we can check</p><pre><code class="language-julia hljs">mean(Q_bayes) - Qempirical</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 Matrix{Float64}:
 -2.22045e-16  -2.22045e-16  -1.33227e-15
  2.22045e-16   4.44089e-16   1.11022e-16
  1.11022e-16   2.22045e-16   1.33227e-15</code></pre><p>However, we have more than just a mean value for the Bayesian matrix, we also have variances </p><pre><code class="language-julia hljs">var(Q_bayes)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 Matrix{Float64}:
 0.0185982   0.0609135  0.109155
 0.00442456  0.0913703  0.0318369
 0.0142707   0.0304568  0.140992</code></pre><p>and standard deviations</p><pre><code class="language-julia hljs">std(Q_bayes)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 Matrix{Float64}:
 0.136375   0.246807  0.330386
 0.0665173  0.302275  0.178429
 0.11946    0.174519  0.375489</code></pre><p>We can check that the mean falls within two standard deviations of the true empirical estimate with high probability</p><pre><code class="language-julia hljs">abs.(mean(Q_bayes) - Q) .&lt;  2 * std(Q_bayes)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3×3 BitMatrix:
 1  1  1
 1  1  1
 1  1  1</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../Continuous Time/convergence/">« Convergence of Generators</a><a class="docs-footer-nextpage" href="../constructing_prior/">Constructing Prior Distributions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 7 December 2023 16:58">Thursday 7 December 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
